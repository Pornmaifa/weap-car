{% load static %}
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แดชบอร์ด - WarpCar</title>
    <link href="{% static 'dist/styles.css' %}?v=4" rel="stylesheet">
</head>
<body class="bg-gray-100">

    {% include 'users/navbar.html' %}

    <div class="container mx-auto flex flex-col md:flex-row p-4 md:p-8 gap-8">

         {% include 'users/sidebar.html' %}
            
        
        <main class="flex-1 p-8 md:p-12">
            
            <div class="flex items-center gap-4 mb-2">
                <h1 class="text-4xl font-bold text-gray-800">แดชบอร์ด</h1>
                <a href="{% url 'add_car_step1' %}" class="bg-[#47B3C4] hover:bg-[#3a9faa] text-white px-4 py-2 rounded shadow flex items-center gap-2 font-medium">
                    เพิ่มรถ <span>+</span>
                </a>
            </div>
            <p class="text-gray-600 mb-8">สรุปรถเช่าของคุณ</p>

            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                <div class="grid grid-cols-12 gap-4 p-4 border-b text-gray-500 font-medium text-center">
                    <div class="col-span-4 text-left pl-4">รถ</div>
                    <div class="col-span-3">สถานะ</div>
                    <div class="col-span-2">ยอดจอง</div>
                    <div class="col-span-2">รายได้รวม</div>
                    <div class="col-span-1"></div> </div>

                {% for car in cars %}
                <div class="grid grid-cols-12 gap-4 p-4 border-b items-center text-center hover:bg-gray-50 transition">
                    
                    <div class="col-span-4 flex items-center gap-4 text-left pl-4">
                        {% if car.images.all %}
                            <img src="{{ car.images.first.image.url }}" class="h-16 w-24 object-cover rounded-md">
                        {% else %}
                            <div class="h-16 w-24 bg-gray-200 rounded-md flex items-center justify-center text-xs text-gray-500">ไม่มีรูป</div>
                        {% endif %}

                        <span class="font-bold text-lg text-gray-800">{{ car.brand }} {{ car.model }}</span>
                    </div>

                    <div class="col-span-3">
                        {% if car.status == 'PENDING' %}
                            <span class="text-red-500 font-medium">รออนุมัติ</span>
                        {% elif car.status == 'AVAILABLE' %}
                            <span class="text-gray-800">ว่าง</span>
                        {% else %}
                            <span class="text-gray-800">ไม่พร้อมใช้งาน</span>
                        {% endif %}
                    </div>

                    <div class="col-span-2 text-gray-800 font-medium">
                        0 </div>

                    <div class="col-span-2 text-gray-800 font-medium">
                        0 </div>

                    <div class="col-span-1 flex gap-2 justify-end pr-4">
                        <a href="#" class="bg-[#47B3C4] text-white text-xs px-3 py-1 rounded hover:bg-[#3a9faa]">
                            แก้ไข
                        </a>
                        <form method="POST" action="{% url 'dashboard' %}" 
                            onsubmit="return confirm('คุณต้องการลบรถคันนี้หรือไม่?');">
                            {% csrf_token %}
                            <input type="hidden" name="delete_car_id" value="{{ car.id }}">
                            <button type="submit"
                                    class="bg-gray-500 text-white text-xs px-3 py-1 rounded hover:bg-gray-600">
                                ลบ
                            </button>
                        </form>

                    </div>
                </div>
                {% empty %}
                <div class="p-8 text-center text-gray-500">
                    คุณยังไม่มีรถเช่า <br>
                    <a href="{% url 'add_car_step1' %}" class="text-[#47B3C4] hover:underline">เริ่มเพิ่มรถคันแรกของคุณเลย!</a>
                </div>
                {% endfor %}

            </div>
        </main>
    </div>

</body>
</html>